# Project 8 - Pentesting Live Targets

Time spent: **5** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue
####Target: https://35.184.88.145/blue/public/

Vulnerability #1: Session Hijacking/Fixation
Description: 
>The left browser is the actual user, browser A. The right browser is in incogito to simulate an hacker, browser B. Login into the website in A. Using the browsers developer network tool to locate the session id. This session id can be used to login as the actual user without username & password credentials. In browser B, visit the website at /public/hacktools/change_session_id.php and paste the user session id to login.

![GIF](#)

Vulnerability #2: SQL Injection (SQLi)
Description: 
>Most of the data input received by these websites is being sanitized properly. However, if you add `' OR SLEEP(10)=0--'` as the ID of a user. This injection allow the website to wait 10 seconds before appearing.

![GIF](#)

## Green
####Target: https://35.184.88.145/green/public/

Vulnerability #1: Username Enumeration
Description: 
>The website displays error message incorrectly. Existing usernames with incorrect password shows a bolded error message. If the username dont exist, the error message is not bolded. For example, the username  "jmonroe99" will show an bolded eroor message if the password is incorrect

![GIF](#)

Vulnerability #2: Cross-Site Scripting (XSS)
Description: 
>The website allows javascript to be injected into the fcontact form. For example, paste `<script>alert('Mallory found the XSS!');</script>` into the form. Then login to see all the feedbacks.

![GIF](#)

Bonus Vulnerability : Cross-Site Scripting (XSS)
Description: 
> Build on Vulnerability #2 (Cross-Site Scripting). Experiment to see if you can use XSS to: a) direct the user to a new URL, b) read cookie data, c) set cookie data.

>This injected script will show and change the user session id. This work for both https://35.184.88.145/ & https://104.198.208.81/. By changing the session id, when the user revisits feedback they are logged out making them unable to access feedbacks.
``` 
  <script>
    document.cookie = "PHPSESSID=Bonus";
    alert(`Cookies ${document.cookie}`);
    document.location = "https://104.198.208.81/green/public/hacktools/change_session_id.php";
  </script>
```
![GIF](#)


## Red
####Target: https://35.184.88.145/red/public/

Vulnerability #1: Cross-Site Request Forgery (CSRF)
Description: 
>Visit the user list. Then visit [CSRF Live Site](https://gzd1v.csb.app/) that is run the [index.html](#). This site should create a user without the admins permissions.

Vulnerability #2: Insecure Direct Object Reference (IDOR)
Description: 
> Non login users can find a Salesperson by changing the id in the url. However, profiles that is not surpose to private is public. For example, `id=10` is public. A solution is to redirect unauthoricated user back to find a saleperson page.

![GIF](#)

## Notes

The CSRF red vulnerablity requires finding which form that dont require the csrf token field `csrf_token`. Burp's Proxy & Repeater tool is useful to help find it.    

In the bonus vulnerablity, although I was able to change the session id to logout a user, when the injected script redirect to show the user session id it doesnt show the one I create eventhough it has been change in the background. This confused me eventhough the hack worked.